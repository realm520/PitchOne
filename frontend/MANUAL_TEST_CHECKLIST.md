# 串关功能手动测试检查清单

## 测试环境
- 开发服务器: http://localhost:3000
- 测试网络: Anvil 本地链
- 测试账户: 确保已连接钱包

---

## 🧪 测试场景

### 1. 市场详情页 - 基本功能

#### ✅ 测试步骤：访问市场详情页
1. 打开 http://localhost:3000/markets
2. 点击任意一个市场卡片
3. 进入市场详情页

**预期结果**：
- [ ] 页面正常加载
- [ ] 显示市场信息（队伍名称、赛事信息）
- [ ] 显示结果选项（如：主队胜、平局、客队胜）

#### ✅ 测试步骤：检查按钮布局
**预期结果**：
- [ ] 每个结果卡片有两个按钮
- [ ] 上方按钮：「立即下注」（霓虹蓝色）
- [ ] 下方按钮：「+ 加入串关」（边框样式）
- [ ] 两个按钮垂直排列

---

### 2. 添加到串关功能

#### ✅ 测试步骤：首次添加
1. 在市场详情页
2. 点击任意结果的「+ 加入串关」按钮

**预期结果**：
- [ ] 显示成功通知（带🎯图标）
- [ ] 通知内容：「已添加到串关: [结果名称]」
- [ ] 按钮文字变为「✓ 已加入串关」
- [ ] 按钮变为灰色禁用状态
- [ ] 右下角购物车图标出现徽章「1」

#### ✅ 测试步骤：添加多个市场
1. 返回市场列表（/markets）
2. 进入另一个市场
3. 点击「+ 加入串关」

**预期结果**：
- [ ] 显示成功通知
- [ ] 购物车徽章变为「2」
- [ ] 第一个市场的选择仍然保持

#### ✅ 测试步骤：同一市场选择不同结果
1. 在市场A选择「主队胜」
2. 再次点击「客队胜」的「+ 加入串关」

**预期结果**：
- [ ] 「主队胜」按钮恢复为「+ 加入串关」
- [ ] 「客队胜」按钮变为「✓ 已加入串关」
- [ ] 购物车徽章仍然是「1」（替换，不是增加）

---

### 3. 购物车交互

#### ✅ 测试步骤：打开购物车
1. 添加至少2个结果到串关
2. 点击右下角购物车图标

**预期结果**：
- [ ] 购物车展开
- [ ] 显示所有选择的结果
- [ ] 每个结果显示：
  - 市场名称（如「曼联 vs 曼城」）
  - 结果名称（如「主队胜」）
  - 赔率（如「2.5x」）
  - 移除按钮（❌）

#### ✅ 测试步骤：从购物车移除
1. 打开购物车
2. 点击某个结果的移除按钮

**预期结果**：
- [ ] 结果从列表中消失
- [ ] 购物车徽章数字减1
- [ ] 返回该市场详情页，按钮恢复为「+ 加入串关」

#### ✅ 测试步骤：清空购物车
1. 打开购物车
2. 点击「清空全部」按钮

**预期结果**：
- [ ] 所有结果被清空
- [ ] 购物车徽章消失
- [ ] 显示空状态提示

---

### 4. 跨页面状态持久化

#### ✅ 测试步骤：页面刷新
1. 添加结果到串关
2. 刷新浏览器（F5）

**预期结果**：
- [ ] ⚠️ **注意**：React Context不会在刷新后保持
- [ ] 购物车被清空（这是预期行为）
- [ ] （如需持久化，需要使用localStorage，这是后续优化）

#### ✅ 测试步骤：页面导航
1. 在市场A添加结果
2. 导航到市场B（不要刷新）
3. 返回市场A

**预期结果**：
- [ ] 之前添加的结果仍然显示为「✓ 已加入串关」
- [ ] 购物车徽章保持正确数字

---

### 5. 串关页面集成

#### ✅ 测试步骤：导航到串关页面
1. 添加至少2个结果
2. 打开购物车
3. 点击「前往串关页面」按钮

**预期结果**：
- [ ] URL变为 /parlay
- [ ] 页面显示串关构建器
- [ ] 左侧显示所有选择的结果
- [ ] 显示组合赔率（各个赔率相乘）

#### ✅ 测试步骤：查看组合赔率
假设选择：
- 市场A：主队胜 2.0x
- 市场B：大于2.5球 3.0x

**预期结果**：
- [ ] 组合赔率显示：6.0x
- [ ] 显示每条腿的详细信息
- [ ] 显示相关性惩罚（如果有）

#### ✅ 测试步骤：输入下注金额
1. 在串关页面
2. 输入金额：100 USDC

**预期结果**：
- [ ] 显示潜在收益：600 USDC
- [ ] 显示净盈利：500 USDC
- [ ] 如果余额不足，显示错误提示

---

### 6. 边界情况测试

#### ✅ 测试步骤：市场锁盘
1. 访问已锁盘的市场（状态：Locked）

**预期结果**：
- [ ] 「立即下注」按钮显示「已锁盘」并禁用
- [ ] 「加入串关」按钮被禁用
- [ ] 鼠标悬停时显示禁用原因（可选）

#### ✅ 测试步骤：达到上限
1. 添加10个市场（最大限制）

**预期结果**：
- [ ] 第10个添加成功
- [ ] 尝试添加第11个时：
  - 显示错误通知
  - 或按钮被禁用
  - 或显示提示信息

#### ✅ 测试步骤：未连接钱包
1. 断开钱包连接
2. 访问市场详情页

**预期结果**：
- [ ] 仍然可以查看市场信息
- [ ] 「立即下注」按钮显示「连接钱包」
- [ ] 「加入串关」按钮禁用或提示连接钱包

---

### 7. UI/UX 测试

#### ✅ 测试步骤：响应式设计
1. 在不同屏幕尺寸测试
   - 桌面（1920x1080）
   - 平板（768x1024）
   - 手机（375x667）

**预期结果**：
- [ ] 按钮在所有尺寸下可点击
- [ ] 购物车在手机上正常显示
- [ ] 文字不会溢出

#### ✅ 测试步骤：加载状态
1. 在慢网络下测试（Chrome DevTools → Network → Slow 3G）

**预期结果**：
- [ ] 显示加载骨架或spinner
- [ ] 按钮在加载时禁用
- [ ] 不会出现闪烁或跳动

#### ✅ 测试步骤：动画和过渡
**预期结果**：
- [ ] 购物车展开/收起有平滑动画
- [ ] 通知显示/消失有淡入淡出效果
- [ ] 按钮状态变化有过渡效果

---

### 8. 错误处理测试

#### ✅ 测试步骤：网络错误
1. 添加结果到串关
2. 断开网络
3. 尝试创建串关

**预期结果**：
- [ ] 显示友好错误消息
- [ ] 提供重试选项
- [ ] 不会丢失已选择的结果

#### ✅ 测试步骤：交易失败
1. 准备创建串关
2. 在钱包中拒绝交易

**预期结果**：
- [ ] 显示「交易被拒绝」通知
- [ ] 返回可编辑状态
- [ ] 不会清空选择

---

## 🎯 关键指标

### 功能完整性
- [ ] 所有核心功能正常工作
- [ ] 没有阻塞性bug
- [ ] 边界情况处理正确

### 用户体验
- [ ] 操作流畅，无卡顿
- [ ] 反馈及时（<500ms）
- [ ] 错误提示友好

### 视觉一致性
- [ ] 按钮样式统一
- [ ] 颜色符合设计规范
- [ ] 间距和对齐正确

---

## 📊 测试结果记录

### 测试人员: _______________
### 测试日期: _______________
### 浏览器版本: _______________

### 发现的问题

| 序号 | 问题描述 | 严重程度 | 复现步骤 | 截图 |
|------|---------|---------|---------|------|
| 1    |         | 🔴高/🟡中/🟢低 |         |      |
| 2    |         |         |         |      |
| 3    |         |         |         |      |

### 总体评价
- 通过率: _____ / _____ (___%)
- 是否可以发布: ☐ 是  ☐ 否
- 备注: _______________

---

## 🚀 快速测试命令

```bash
# 启动开发服务器
pnpm --filter @pitchone/user dev

# 访问测试页面
# 市场列表: http://localhost:3000/markets
# 串关页面: http://localhost:3000/parlay
# 示例市场: http://localhost:3000/markets/0x...

# 检查控制台错误
# 打开 Chrome DevTools (F12) → Console
# 应该没有红色错误
```

---

## 📝 测试小贴士

1. **使用浏览器开发工具**
   - Console: 查看错误和日志
   - Network: 检查API调用
   - React DevTools: 查看组件状态

2. **测试不同状态**
   - 空状态（无选择）
   - 加载状态
   - 错误状态
   - 成功状态

3. **清除缓存**
   - 测试前清除浏览器缓存
   - 使用无痕模式避免缓存干扰

4. **记录问题**
   - 截图或录屏
   - 记录详细复现步骤
   - 注明浏览器和环境信息
