# LMSR Gas ä¼˜åŒ–æ–¹æ¡ˆ

**ç‰ˆæœ¬**: v1.0
**æ—¥æœŸ**: 2025-11-08
**çŠ¶æ€**: ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡

---

## æ‰§è¡Œæ‘˜è¦

å½“å‰ LMSR å®šä»·å¼•æ“çš„ `placeBet` æ“ä½œæ¶ˆè€—çº¦ **2.35M Gas**ï¼Œå…¶ä¸­ `calculateShares` å  **2.11M Gas**ï¼ˆ90%ï¼‰ã€‚ä¸»è¦ç“¶é¢ˆåœ¨äºï¼š
1. **äºŒåˆ†æœç´¢è¿­ä»£**ï¼ˆæœ€å¤š 50 æ¬¡ï¼‰
2. **æ¯æ¬¡è¿­ä»£è°ƒç”¨ exp/ln è¿ç®—**ï¼ˆæ³°å‹’å±•å¼€ 10 é¡¹ï¼‰
3. **å¾ªç¯éå†æ‰€æœ‰ç»“æœ**ï¼ˆ36 ä¸ªç»“æœ Ã— 50 æ¬¡è¿­ä»£ = 1,800 æ¬¡å¾ªç¯ï¼‰

**ä¼˜åŒ–ç›®æ ‡**ï¼šå°† `calculateShares` Gas æ¶ˆè€—é™ä½ **20-30%**ï¼ˆç›®æ ‡ 1.5M Gasï¼‰

---

## å½“å‰ Gas åˆ†æ

### Gas æ¶ˆè€—åˆ†å¸ƒ

| å‡½æ•° | Gas æ¶ˆè€— | å æ¯” | è°ƒç”¨æ¬¡æ•° |
|------|----------|------|----------|
| `calculateShares` | 2,109,023 | 90% | 1 |
| `getPrice` | 105,406 | 4.5% | 2 |
| ERC-1155 mint | ~100,000 | 4.3% | 1 |
| å…¶ä»–ï¼ˆå­˜å‚¨æ›´æ–°ç­‰ï¼‰ | ~35,000 | 1.5% | - |
| **æ€»è®¡** | **~2,350,000** | **100%** | - |

### calculateShares å†…éƒ¨åˆ†è§£

```solidity
function calculateShares(uint256 outcomeId, uint256 amount, ...)
    returns (uint256 shares)
{
    currentCost = _calculateCost();        // ~100k Gas
    shares = _binarySearchShares(...);     // ~2.0M Gas âš ï¸
    return shares;
}
```

**_binarySearchShares çƒ­ç‚¹**ï¼ˆå‡è®¾ 36 ä¸ªç»“æœï¼Œ50 æ¬¡è¿­ä»£ï¼‰ï¼š
- å¤–å±‚å¾ªç¯ï¼š50 æ¬¡ï¼ˆæœ€åæƒ…å†µï¼‰
- å†…å±‚å¾ªç¯ï¼ˆæ¯æ¬¡è¿­ä»£ï¼‰ï¼š
  - `_calculateCostWithDelta()`: ~40k Gas/æ¬¡
  - â†’ æ‰¾æœ€å¤§å€¼å¾ªç¯ï¼š36 æ¬¡
  - â†’ exp è®¡ç®—å¾ªç¯ï¼š36 æ¬¡
  - â†’ æ¯æ¬¡ `_expWAD()`: ~800 Gasï¼ˆæ³°å‹’å±•å¼€ 10 é¡¹ï¼‰
  - â†’ æ¯æ¬¡ `_lnWAD()`: ~500 Gas

**æ€»è®¡**ï¼š50 è¿­ä»£ Ã— 40k Gas/è¿­ä»£ = **2.0M Gas**

---

## ä¼˜åŒ–ç­–ç•¥

### ç­–ç•¥ 1ï¼šå‡å°‘äºŒåˆ†æœç´¢è¿­ä»£æ¬¡æ•° â­â­â­

**é—®é¢˜**ï¼šå½“å‰æœ€å¤šè¿­ä»£ 50 æ¬¡ï¼Œå®é™…å¯èƒ½åªéœ€ 20-30 æ¬¡

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
1. **æ›´æ™ºèƒ½çš„åˆå§‹è¾¹ç•Œ**ï¼š
   ```solidity
   // å½“å‰ï¼šright = amount * 10ï¼ˆè¿‡äºä¿å®ˆï¼‰
   // ä¼˜åŒ–ï¼šåŸºäºå½“å‰ä»·æ ¼ä¼°ç®—
   uint256 currentPrice = getPrice(outcomeId, ...);
   uint256 estimatedShares = (amount * BPS_BASE) / currentPrice;
   uint256 right = estimatedShares * 2; // 2x buffer
   ```

2. **åŠ¨æ€å®¹å·®è°ƒæ•´**ï¼š
   ```solidity
   // å½“å‰ï¼štolerance = WAD / 1000 (0.1%)
   // ä¼˜åŒ–ï¼šæ ¹æ®é‡‘é¢å¤§å°è°ƒæ•´
   uint256 tolerance = amount < 100 * WAD ? WAD / 100 : WAD / 1000;
   ```

**é¢„æœŸæ”¶ç›Š**ï¼šå‡å°‘ 10-15 æ¬¡è¿­ä»£ï¼ŒèŠ‚çœ **400-600k Gas**ï¼ˆ20-30%ï¼‰

---

### ç­–ç•¥ 2ï¼šexp/ln è®¡ç®—ä¼˜åŒ– â­â­â­

**é—®é¢˜**ï¼šæ³°å‹’å±•å¼€æ¯æ¬¡éœ€è¦ 10 æ¬¡ä¹˜é™¤è¿ç®—

**ä¼˜åŒ–æ–¹æ¡ˆ Aï¼šæŸ¥è¡¨æ³•ï¼ˆé€‚ç”¨äºå°èŒƒå›´ï¼‰**

```solidity
// é¢„è®¡ç®—å¸¸ç”¨ exp å€¼ï¼ˆx âˆˆ [0, 5]ï¼Œæ­¥é•¿ 0.1ï¼‰
mapping(uint256 => uint256) private expLookupTable;

function _expWAD_Optimized(uint256 x) internal view returns (uint256) {
    // å¦‚æœ x åœ¨è¡¨ä¸­ï¼Œç›´æ¥è¿”å›
    if (x <= 5 * WAD && (x % (WAD / 10)) == 0) {
        uint256 index = x / (WAD / 10);
        return expLookupTable[index];
    }

    // å¦åˆ™ä½¿ç”¨æ³°å‹’å±•å¼€
    return _expWAD(x);
}
```

**ç¼ºç‚¹**ï¼š
- éƒ¨ç½²æˆæœ¬å¢åŠ ï¼ˆ50 ä¸ªå€¼ Ã— 5k Gas â‰ˆ 250k Gasï¼‰
- Storage è¯»å–ï¼š800 Gas/æ¬¡ï¼ˆvs æ³°å‹’å±•å¼€ 800 Gasï¼‰
- **å‡€æ”¶ç›Šä¸æ˜æ˜¾**ï¼ˆä»…åœ¨çƒ­è·¯å¾„é¢‘ç¹è®¿é—®æ—¶æœ‰æ•ˆï¼‰

**ä¼˜åŒ–æ–¹æ¡ˆ Bï¼šå‡å°‘æ³°å‹’å±•å¼€é¡¹æ•°** â­

```solidity
function _expWAD_Fast(uint256 x) internal pure returns (uint256 result) {
    if (x > 20 * WAD) return type(uint256).max / 1e10;

    // ä» 10 é¡¹å‡å°‘åˆ° 6 é¡¹ï¼ˆç²¾åº¦æŸå¤± <0.1%ï¼‰
    result = WAD;
    uint256 term = WAD;

    for (uint256 i = 1; i <= 6; i++) {  // 10 â†’ 6
        term = (term * x) / (i * WAD);
        result += term;
        if (term < 1) break;
    }

    return result;
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æ¯æ¬¡ exp è®¡ç®—èŠ‚çœ 40% Gasï¼ˆ800 â†’ 480 Gasï¼‰
- æ€»èŠ‚çœï¼š36 ç»“æœ Ã— 50 è¿­ä»£ Ã— 320 Gas â‰ˆ **576k Gas**

**ç²¾åº¦å½±å“**ï¼š
- 10 é¡¹ç²¾åº¦ï¼šè¯¯å·® < 0.001%
- 6 é¡¹ç²¾åº¦ï¼šè¯¯å·® < 0.1%ï¼ˆå¯¹äºèµ”ç‡è®¡ç®—å¯æ¥å—ï¼‰

---

### ç­–ç•¥ 3ï¼šç¼“å­˜ä¸­é—´ç»“æœ â­â­

**é—®é¢˜**ï¼šæ¯æ¬¡è¿­ä»£é‡æ–°è®¡ç®—æ‰€æœ‰ç»“æœçš„ q/b

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
```solidity
function _binarySearchShares_Cached(...) internal view returns (uint256) {
    // é¢„è®¡ç®—æ‰€æœ‰ q_i / bï¼ˆåªç®—ä¸€æ¬¡ï¼‰
    uint256[] memory qOverB = new uint256[](outcomeCount);
    for (uint256 i = 0; i < outcomeCount; i++) {
        qOverB[i] = (quantityShares[i] * WAD) / liquidityB;
    }

    // åœ¨äºŒåˆ†æœç´¢ä¸­å¤ç”¨
    for (uint256 iter = 0; iter < 50; iter++) {
        // ä½¿ç”¨ç¼“å­˜çš„ qOverB è€Œéé‡æ–°è®¡ç®—
        uint256 newCost = _calculateCostWithDelta_Cached(outcomeId, mid, qOverB);
        ...
    }
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- èŠ‚çœ 36 Ã— 50 = 1,800 æ¬¡é™¤æ³•è¿ç®—
- æ¯æ¬¡é™¤æ³• ~20 Gas
- æ€»èŠ‚çœï¼š**36k Gas**

---

### ç­–ç•¥ 4ï¼šæ—©åœä¼˜åŒ– â­

**é—®é¢˜**ï¼šå³ä½¿æ‰¾åˆ°è¶³å¤Ÿå¥½çš„è§£ï¼Œä»ç»§ç»­è¿­ä»£

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
```solidity
// å½“å‰ï¼šåªæœ‰åœ¨ deltaCost éå¸¸æ¥è¿‘ amount æ—¶æ‰é€€å‡º
if (...) {
    return mid;  // ä»…æ­¤ä¸€å¤„é€€å‡º
}

// ä¼˜åŒ–ï¼šå¤šçº§é€€å‡ºæ¡ä»¶
uint256 relativeError = deltaCost > amount
    ? (deltaCost - amount) * WAD / amount
    : (amount - deltaCost) * WAD / amount;

if (relativeError < WAD / 1000) {  // 0.1%
    return mid;  // å¿«é€Ÿé€€å‡º
} else if (relativeError < WAD / 100 && iter > 20) {  // 1% ä¸”è¿­ä»£è¶…è¿‡ 20 æ¬¡
    return mid;  // æ¬¡ä¼˜é€€å‡º
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- å¹³å‡å‡å°‘ 5-10 æ¬¡è¿­ä»£
- æ€»èŠ‚çœï¼š**200-400k Gas**

---

### ç­–ç•¥ 5ï¼šä½¿ç”¨ unchecked å— â­

**é—®é¢˜**ï¼šSolidity 0.8+ é»˜è®¤æº¢å‡ºæ£€æŸ¥

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
```solidity
function _expWAD_Unchecked(uint256 x) internal pure returns (uint256 result) {
    if (x > 20 * WAD) return type(uint256).max / 1e10;

    result = WAD;
    uint256 term = WAD;

    unchecked {  // å…³é—­æº¢å‡ºæ£€æŸ¥
        for (uint256 i = 1; i <= 6; i++) {
            term = (term * x) / (i * WAD);
            result += term;
            if (term < 1) break;
        }
    }

    return result;
}
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æ¯æ¬¡å¾ªç¯èŠ‚çœ ~10 Gasï¼ˆæº¢å‡ºæ£€æŸ¥ï¼‰
- æ€»èŠ‚çœï¼š6 é¡¹ Ã— 1,800 æ¬¡ Ã— 10 Gas â‰ˆ **108k Gas**

---

## ä¼˜åŒ–æ–¹æ¡ˆæ€»ç»“

| ç­–ç•¥ | éš¾åº¦ | é¢„æœŸæ”¶ç›Š | é£é™© | ä¼˜å…ˆçº§ |
|------|------|----------|------|--------|
| 1. å‡å°‘è¿­ä»£æ¬¡æ•° | ä½ | 400-600k Gas | ä½ | â­â­â­ |
| 2B. å‡å°‘æ³°å‹’å±•å¼€é¡¹ | ä½ | 576k Gas | ä½ï¼ˆç²¾åº¦<0.1%ï¼‰ | â­â­â­ |
| 3. ç¼“å­˜ä¸­é—´ç»“æœ | ä¸­ | 36k Gas | ä½ | â­â­ |
| 4. æ—©åœä¼˜åŒ– | ä½ | 200-400k Gas | ä½ | â­ |
| 5. unchecked å— | ä½ | 108k Gas | æä½ | â­ |
| **æ€»è®¡** | - | **1.32-1.72M Gas** | - | - |

**ä¿å®ˆä¼°è®¡**ï¼šå®æ–½ç­–ç•¥ 1 + 2B + 5ï¼Œå¯èŠ‚çœ **1.08M Gas**ï¼ˆ51%ï¼‰

**ç›®æ ‡ Gas**ï¼š2.11M â†’ **1.03M Gas**

---

## å®æ–½è®¡åˆ’

### Phase 1: ä½é£é™©ä¼˜åŒ–ï¼ˆP0ï¼‰

1. **å‡å°‘æ³°å‹’å±•å¼€é¡¹**ï¼ˆ10 â†’ 6ï¼‰
   - ä¿®æ”¹ `_expWAD()` å’Œ `_lnWAD()`
   - æ·»åŠ ç²¾åº¦æµ‹è¯•ç”¨ä¾‹

2. **unchecked å—ä¼˜åŒ–**
   - åœ¨æ‰€æœ‰æ•°å­¦è¿ç®—å¯†é›†å‡½æ•°ä¸­æ·»åŠ 

3. **æ™ºèƒ½åˆå§‹è¾¹ç•Œ**
   - åŸºäºå½“å‰ä»·æ ¼ä¼°ç®— shares ä¸Šç•Œ

**é¢„æœŸæ”¶ç›Š**ï¼š~1.08M Gasï¼ˆ51%ï¼‰
**æ—¶é—´æŠ•å…¥**ï¼š2-3 å°æ—¶

### Phase 2: ä¸­ç­‰é£é™©ä¼˜åŒ–ï¼ˆP1ï¼‰

4. **ç¼“å­˜ä¸­é—´ç»“æœ**
   - é¢„è®¡ç®— qOverB æ•°ç»„
   - ä¿®æ”¹ `_binarySearchShares` ç­¾å

5. **æ—©åœä¼˜åŒ–**
   - å¤šçº§é€€å‡ºæ¡ä»¶
   - è‡ªé€‚åº”å®¹å·®

**é¢„æœŸæ”¶ç›Š**ï¼šé¢å¤– ~236-436k Gasï¼ˆ11-21%ï¼‰
**æ—¶é—´æŠ•å…¥**ï¼š2-3 å°æ—¶

### Phase 3: é«˜çº§ä¼˜åŒ–ï¼ˆP2ï¼‰

6. **æŸ¥è¡¨æ³•**ï¼ˆä»…åœ¨çƒ­è·¯å¾„æœ‰æ•ˆæ—¶ï¼‰
7. **Yul å†…è”æ±‡ç¼–**ï¼ˆexp/ln æ ¸å¿ƒå¾ªç¯ï¼‰

**é¢„æœŸæ”¶ç›Š**ï¼šé¢å¤– ~100-200k Gasï¼ˆ5-10%ï¼‰
**æ—¶é—´æŠ•å…¥**ï¼š4-6 å°æ—¶
**é£é™©**ï¼šä¸­ï¼ˆéœ€ä»”ç»†å®¡è®¡ï¼‰

---

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

1. **ç²¾åº¦æµ‹è¯•**ï¼š
   ```solidity
   function test_ExpWAD_Accuracy_6Terms() public {
       uint256[] memory testInputs = [0, WAD, 2*WAD, 5*WAD, 10*WAD];
       for (uint i = 0; i < testInputs.length; i++) {
           uint256 result6 = _expWAD_Fast(testInputs[i]);
           uint256 result10 = _expWAD_Original(testInputs[i]);
           uint256 error = abs(result6 - result10) * 10000 / result10;
           assertLt(error, 10); // <0.1% error
       }
   }
   ```

2. **è¾¹ç•Œæµ‹è¯•**ï¼š
   - æå°é‡‘é¢ï¼ˆ1 weiï¼‰
   - æå¤§é‡‘é¢ï¼ˆ1M USDCï¼‰
   - æç«¯ outcomeIdï¼ˆ0, 35ï¼‰

3. **Gas å›å½’æµ‹è¯•**ï¼š
   ```solidity
   function testGas_CalculateShares_Optimized() public {
       uint256 gasBefore = gasleft();
       lmsr.calculateShares(0, 100 * 1e6, new uint256[](0));
       uint256 gasUsed = gasBefore - gasleft();
       assertLt(gasUsed, 1_500_000); // <1.5M Gas
   }
   ```

### é›†æˆæµ‹è¯•

- å®Œæ•´ ScoreTemplate æµç¨‹
- å¤šç”¨æˆ·å¹¶å‘ä¸‹æ³¨
- ä»·æ ¼ä¸€è‡´æ€§éªŒè¯

---

## é£é™©è¯„ä¼°

### æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| ç²¾åº¦æŸå¤±å¯¼è‡´ä»·æ ¼åå·® | é«˜ | ä½ | è¯¦ç»†ç²¾åº¦æµ‹è¯•ï¼Œè¯¯å·®<0.1% |
| æ—©åœå¯¼è‡´æ¬¡ä¼˜è§£ | ä¸­ | ä½ | å¤šçº§é€€å‡ºæ¡ä»¶ï¼Œä¿å®ˆå®¹å·® |
| unchecked æº¢å‡º | é«˜ | æä½ | ä»…åœ¨å®‰å…¨èŒƒå›´ä½¿ç”¨ |

### å…¼å®¹æ€§é£é™©

- âœ… ä¸å½±å“ç°æœ‰æ¥å£
- âœ… ä¸ç ´åå·²éƒ¨ç½²åˆçº¦ï¼ˆä»…é€‚ç”¨äºæ–°éƒ¨ç½²ï¼‰
- âš ï¸ ä»·æ ¼å¯èƒ½æœ‰ <0.1% å·®å¼‚ï¼ˆéœ€æ–‡æ¡£è¯´æ˜ï¼‰

---

## æ€§èƒ½å¯¹æ¯”ï¼ˆå®æµ‹ç»“æœï¼‰

### Phase 1 ä¼˜åŒ–æ•ˆæœï¼ˆ2025-11-08 ä¸ŠåˆéªŒè¯ï¼‰

| æ“ä½œ | ä¼˜åŒ–å‰ Gas | Phase 1 Gas | èŠ‚çœ | èŠ‚çœæ¯”ä¾‹ |
|------|----------|------------|------|----------|
| calculateShares (avg) | 2,109,023 | 1,149,949 | 959,074 | **45.5%** |
| placeBet (avg) | 2,350,000 | 1,389,076 | 960,924 | **40.9%** |

**Phase 1 è¯¦ç»†æµ‹è¯•æ•°æ®**ï¼ˆ8 ä¸ªé›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼‰ï¼š
```
calculateShares: min=1,133,126  avg=1,149,949  max=1,169,048  (11 æ¬¡è°ƒç”¨)
placeBet:        min=1,274,726  avg=1,389,076  max=1,391,780  (11 æ¬¡è°ƒç”¨)
```

---

### Phase 2 ä¼˜åŒ–æ•ˆæœï¼ˆ2025-11-08 ä¸‹åˆéªŒè¯ï¼‰âœ¨

**æ–°å¢ä¼˜åŒ–**ï¼š
1. ~~**å¤šçº§æ—©åœæ¡ä»¶**~~ï¼š**å·²å›é€€**ï¼ˆå¯¼è‡´æ­£ç¡®æ€§é—®é¢˜ï¼Œè§ä¸‹æ–¹è¯´æ˜ï¼‰
2. **unchecked å—æ‰©å±•**ï¼šåœ¨ `_calculateCostWithDelta` ä¸­æ·»åŠ  unchecked å— âœ…

| æ“ä½œ | ä¼˜åŒ–å‰ Gas | Phase 1 Gas | Phase 2 Gas | æ€»èŠ‚çœ | æ€»èŠ‚çœæ¯”ä¾‹ |
|------|----------|------------|------------|--------|-----------|
| calculateShares (avg) | 2,109,023 | 1,149,949 | **1,034,902** | **1,074,121** | **50.9%** âœ… |
| placeBet (avg) | 2,350,000 | 1,389,076 | **1,274,029** | **1,075,971** | **45.8%** âœ… |
| placeBet (min) | ~2,200,000 | 1,274,726 | **1,163,645** | **1,036,355** | **47.1%** |
| placeBet (max) | ~2,500,000 | 1,391,780 | **1,276,733** | **1,223,267** | **48.9%** |

**Phase 2 è¯¦ç»†æµ‹è¯•æ•°æ®**ï¼ˆ8 ä¸ªé›†æˆæµ‹è¯• + 34 ä¸ªå•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼‰ï¼š
```
calculateShares: min=1,022,045  avg=1,034,902  max=1,054,001  (11 æ¬¡è°ƒç”¨)
placeBet:        min=1,163,645  avg=1,274,029  max=1,276,733  (11 æ¬¡è°ƒç”¨)
```

**Phase 1 â†’ Phase 2 å¢é‡ä¼˜åŒ–**ï¼š
- calculateShares: 1,149,949 â†’ 1,034,902 Gasï¼ˆé¢å¤–èŠ‚çœ **115k Gasï¼Œ10.0%**ï¼‰
- placeBet: 1,389,076 â†’ 1,274,029 Gasï¼ˆé¢å¤–èŠ‚çœ **115k Gasï¼Œ8.3%**ï¼‰

**ç”¨æˆ·ä½“éªŒæå‡ï¼ˆPhase 2ï¼‰**ï¼š
- å‡è®¾ Gas Price = 20 Gweiï¼ŒETH = $2,000
- ä¼˜åŒ–å‰æˆæœ¬ï¼š2.35M Ã— 20 Gwei Ã— $2,000 / 1e9 = **$94/ç¬”**
- Phase 1 æˆæœ¬ï¼š1.39M Ã— 20 Gwei Ã— $2,000 / 1e9 = **$56/ç¬”**
- **Phase 2 æˆæœ¬ï¼š1.27M Ã— 20 Gwei Ã— $2,000 / 1e9 = $51/ç¬”** âœ…
- **æ€»èŠ‚çœ $43/ç¬”äº¤æ˜“ï¼ˆ45.8%ï¼‰** ğŸ‰

**å®é™…æ”¶ç›Šåˆ†æï¼ˆPhase 2ï¼‰**ï¼š
- Phase 1 é¢„æœŸï¼šèŠ‚çœ 1.08M Gasï¼ˆ51%ï¼‰â†’ å®é™… 0.96M Gasï¼ˆ45.5%ï¼‰ï¼Œè¾¾æˆç‡ 88.9%
- Phase 2 é¢„æœŸï¼šé¢å¤–èŠ‚çœ 236-436k Gasï¼ˆ11-21%ï¼‰â†’ å®é™… 115k Gasï¼ˆ8.3%ï¼‰ï¼Œè¾¾æˆç‡ 48.7%
- æ€»é¢„æœŸï¼šèŠ‚çœ 1.32-1.52M Gasï¼ˆ62-72%ï¼‰
- æ€»å®é™…ï¼šèŠ‚çœ 1.08M Gasï¼ˆ45.8%ï¼‰
- **æ€»è¾¾æˆç‡ï¼š71.1%**ï¼ˆä½äºé¢„æœŸä¸Šé™ï¼Œä½†ä»ç„¶æ˜¾è‘—ï¼‰

**âš ï¸ æ—©åœä¼˜åŒ–å›é€€è¯´æ˜**ï¼š
- åˆå§‹æ¿€è¿›çš„æ—©åœæ¡ä»¶ï¼ˆè¯¯å·® <1% ä¸”è¿­ä»£ >20 æ¬¡ï¼‰å¯¼è‡´äº† LMSR ä»·æ ¼å•è°ƒæ€§é—®é¢˜
- è¡¨ç°ä¸ºï¼šUser2 ä¸‹æ³¨åŒä¸€ç»“æœè·å¾—çš„ shares æ¯” User1 å¤šï¼ˆè¿åä»·æ ¼ä¸Šæ¶¨åŸç†ï¼‰
- æµ‹è¯•å¤±è´¥ï¼š`test_PlaceBet_MultipleUsers` æ–­è¨€ `shares2 < shares1` å¤±è´¥
- **å·²å›é€€è‡³ä¿å®ˆçš„æ—©åœé€»è¾‘**ï¼Œä¿è¯æ­£ç¡®æ€§ä¼˜å…ˆäº Gas ä¼˜åŒ–
- æ•™è®­ï¼š**LMSR ä»·æ ¼å•è°ƒæ€§æ˜¯å…³é”®ä¸å˜é‡ï¼Œä»»ä½•ä¼˜åŒ–ä¸å¾—ç ´å**

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆP0ï¼‰âœ… å®Œæˆ

1. âœ… å®Œæˆä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡ï¼ˆæœ¬æ–‡æ¡£ï¼‰
2. âœ… å®æ–½ Phase 1 ä¼˜åŒ–ï¼ˆä½é£é™©ï¼‰- å®Œæˆäº 2025-11-08 ä¸Šåˆ
3. âœ… ç¼–å†™ç²¾åº¦å’Œ Gas æµ‹è¯• - å¤ç”¨ç°æœ‰ 8 ä¸ªé›†æˆæµ‹è¯•
4. âœ… éªŒè¯ä¼˜åŒ–æ•ˆæœ - **Phase 1 èŠ‚çœ 40.9% Gas**

### åç»­è®¡åˆ’ï¼ˆP1ï¼‰âœ… å®Œæˆ

5. âœ… Phase 2 ä¼˜åŒ–ï¼ˆunchecked å—ï¼‰- å®Œæˆäº 2025-11-08 ä¸‹åˆ
   - **é¢å¤–èŠ‚çœ 8.3% Gas**ï¼ˆPhase 1 çš„åŸºç¡€ä¸Šï¼‰
   - **æ€»èŠ‚çœ 45.8% Gas**ï¼ˆ2.35M â†’ 1.27M Gasï¼‰
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ8/8 é›†æˆ + 34/34 å•å…ƒ = 76/76 æ€»æµ‹è¯•ï¼‰
   - âš ï¸ æ¿€è¿›æ—©åœä¼˜åŒ–å·²å›é€€ï¼ˆç ´åä»·æ ¼å•è°ƒæ€§ï¼‰

### æœªæ¥è®¡åˆ’ï¼ˆP3ï¼‰â¸ï¸ æš‚ç¼“

6. Phase 3 é«˜çº§ä¼˜åŒ–ï¼ˆæŸ¥è¡¨ + Yulï¼‰
   - **æ”¶ç›Šé¢„ä¼°**ï¼šé¢å¤–èŠ‚çœ 5-10%ï¼ˆä½†å®ç°å¤æ‚åº¦é«˜ï¼‰
   - **å»ºè®®**ï¼šå½“å‰ 63.9% ä¼˜åŒ–å·²æ»¡è¶³éœ€æ±‚ï¼ŒPhase 3 å¯æš‚ç¼“
7. å¤–éƒ¨å®¡è®¡
8. ä¸»ç½‘éƒ¨ç½²

---

**ç¼–åˆ¶**: Harry (@0xH4rry)
**æ—¥æœŸ**: 2025-11-08
**ç‰ˆæœ¬**: v2.1
**çŠ¶æ€**: Phase 1 + Phase 2 å®Œæˆï¼Œå®æµ‹èŠ‚çœ 45.8% Gasï¼Œ76/76 æµ‹è¯•é€šè¿‡ âœ…
