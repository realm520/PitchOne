# M3 é˜¶æ®µå¼€å‘è®¡åˆ’

**æ—¥æœŸ**: 2025-11-08
**é‡Œç¨‹ç¢‘**: M3 - æ‰©ç©æ³•ä¸å¯æ’æ§½
**é¢„è®¡å‘¨æœŸ**: Week 8-12 (2025-12-17 ~ 2026-01-19)
**æ€»é¢„ä¼°ç‚¹æ•°**: 90 ç‚¹

---

## ğŸ“Š å½“å‰é¡¹ç›®çŠ¶æ€ï¼ˆWeek 7 ç»“æŸï¼‰

### âœ… å·²å®Œæˆéƒ¨åˆ†
1. **æ ¸å¿ƒåˆçº¦**: 15/19 (79%)
2. **æµ‹è¯•è¦†ç›–**: 554 ä¸ªæµ‹è¯•ï¼Œ100% é€šè¿‡ç‡
3. **å¸‚åœºæ¨¡æ¿**: 5/7 (71%)
   - âœ… WDL_Template (51 æµ‹è¯•)
   - âœ… OU_Template å•çº¿ (47 æµ‹è¯•)
   - âœ… OU_MultiLine å¤šçº¿ (23 æµ‹è¯•)
   - âœ… AH_Template (28 æµ‹è¯•)
   - âœ… OddEven_Template (34 æµ‹è¯•)
   - â³ ScoreTemplate (ç²¾ç¡®æ¯”åˆ†) - **M3 å¾…å¼€å‘**
   - â³ PlayerProps_Template (çƒå‘˜é“å…·) - **M3 å¾…å¼€å‘**
4. **å®šä»·å¼•æ“**:
   - âœ… SimpleCPMM (23 æµ‹è¯•, 97.5% è¦†ç›–ç‡)
   - âœ… LinkedLinesController (19 æµ‹è¯•, 92.45% è¦†ç›–ç‡)
   - â³ LMSR - **M3 å¾…å¼€å‘**
5. **ä¸²å…³ç³»ç»Ÿ**:
   - âœ… Basket.sol (538 è¡Œ, 25 æµ‹è¯•, 100% é€šè¿‡) - **å·²å®Œæˆï¼**
   - âœ… CorrelationGuard.sol (387 è¡Œ, 25 æµ‹è¯•, 100% é€šè¿‡) - **å·²å®Œæˆï¼**
6. **M2 è¿è¥é—­ç¯**: 100% å®Œæˆ
   - Campaign, Quest, CreditToken, Coupon, PayoutScaler
7. **Subgraph**: M2 å®Œæ•´éƒ¨ç½²æˆåŠŸ (v0.4.0-m2)

### â³ M3 å¾…å®Œæˆéƒ¨åˆ†
1. **LMSR å®šä»·å¼•æ“** - 30 ç‚¹
2. **ScoreTemplate ç²¾ç¡®æ¯”åˆ†å¸‚åœº** - 25 ç‚¹
3. **PlayerProps_Template çƒå‘˜é“å…·å¸‚åœº** - 15 ç‚¹
4. **Basket/CorrelationGuard Subgraph Mapping** - 10 ç‚¹
5. **é›†æˆæµ‹è¯•ä¸ç«¯åˆ°ç«¯éªŒè¯** - 8 ç‚¹
6. **CLOB æ’æ§½è¯„ä¼°ï¼ˆé€‰é…ï¼‰** - 2 ç‚¹

---

## ğŸ¯ M3 æ ¸å¿ƒç›®æ ‡

### 1. æ‰©å±•å¸‚åœºç©æ³•ï¼ˆæ ¸å¿ƒï¼‰
- å®ç° **LMSR å®šä»·å¼•æ“**ï¼Œæ”¯æŒå¤šç»“æœå¸‚åœºï¼ˆ>3 ä¸ªç»“æœï¼‰
- å®ç° **ç²¾ç¡®æ¯”åˆ†å¸‚åœº**ï¼ˆå¦‚ 0-0, 1-0, 2-1 ç­‰ï¼Œçº¦ 25-50 ä¸ªç»“æœï¼‰
- å®ç° **çƒå‘˜é“å…·å¸‚åœº**ï¼ˆå¦‚è¿›çƒæ•° >1.5, åŠ©æ”»æ•° OU, å°„é—¨æ¬¡æ•°ç­‰ï¼‰

### 2. ä¸²å…³ç³»ç»Ÿå®Œå–„
- âœ… Basket å’Œ CorrelationGuard åˆçº¦å·²å®Œæˆï¼ˆ50 æµ‹è¯•ï¼Œ100% é€šè¿‡ï¼‰
- ğŸ”„ æ·»åŠ  Subgraph Mapping æ”¯æŒï¼ˆç´¢å¼•ä¸²å…³äº‹ä»¶ï¼‰
- ğŸ”„ æ·»åŠ ä¸å¸‚åœºæ¨¡æ¿çš„ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•

### 3. CLOB æ’æ§½è¯„ä¼°ï¼ˆé€‰é…ï¼‰
- è¯„ä¼°ä¸­å¿ƒåŒ–è®¢å•ç°¿ï¼ˆCLOBï¼‰çš„å¿…è¦æ€§
- è®¾è®¡æ’æ§½æ¥å£ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ“‹ è¯¦ç»†ä»»åŠ¡åˆ†è§£

### ä»»åŠ¡ 1: LMSR å®šä»·å¼•æ“ (30 ç‚¹, Week 8-9)

#### èƒŒæ™¯
- LMSR (Logarithmic Market Scoring Rule) æ˜¯é€‚ç”¨äºå¤šç»“æœå¸‚åœºçš„åšå¸‚ç®—æ³•
- ç›¸æ¯” CPMMï¼ŒLMSR åœ¨å¤„ç† >3 ä¸ªç»“æœæ—¶æ›´é«˜æ•ˆä¸”ä»·æ ¼æ›´ç¨³å®š
- ç²¾ç¡®æ¯”åˆ†å¸‚åœºï¼ˆ25-50 ä¸ªç»“æœï¼‰å¿…é¡»ä½¿ç”¨ LMSR

#### å®ç°èŒƒå›´
1. **æ ¸å¿ƒåˆçº¦**: `contracts/src/pricing/LMSR.sol`
   - æˆæœ¬å‡½æ•°: `C(q) = b * ln(Î£ exp(q_i / b))`
   - ä»·æ ¼å‡½æ•°: `p_i = exp(q_i / b) / Î£ exp(q_j / b)`
   - æŠ¥ä»·å‡½æ•°: `quote(outcome, amount)`
   - äº¤æ˜“æ‰§è¡Œ: `executeTrade(outcome, amount)`
   - å‚æ•°: `b` (æµåŠ¨æ€§å‚æ•°)

2. **æ•°å€¼ç¨³å®šæ€§å¤„ç†**
   - ä½¿ç”¨ LogExpMath åº“ï¼ˆæ¥è‡ª Balancer æˆ– PRBMathï¼‰
   - é¿å…æŒ‡æ•°æº¢å‡ºï¼ˆä½¿ç”¨ log-sum-exp æŠ€å·§ï¼‰
   - å¤„ç†æç«¯æ¦‚ç‡ï¼ˆå¦‚ 0.01% æˆ– 99.99%ï¼‰

3. **æ¥å£è®¾è®¡**
   ```solidity
   interface ILMSR {
       function quote(uint256 outcome, uint256 amount) external view returns (uint256 cost, uint256 newPrice);
       function executeTrade(uint256 outcome, uint256 amount) external returns (uint256 cost);
       function getCurrentPrice(uint256 outcome) external view returns (uint256 price);
       function setLiquidityParameter(uint256 newB) external; // onlyOwner
   }
   ```

4. **æµ‹è¯•è®¡åˆ’** (â‰¥25 ä¸ªæµ‹è¯•)
   - å•å…ƒæµ‹è¯•:
     - ä»·æ ¼å‡½æ•°æ­£ç¡®æ€§ï¼ˆä¸ç†è®ºå€¼å¯¹æ¯”ï¼‰
     - æˆæœ¬å‡½æ•°å•è°ƒæ€§
     - æ— å¥—åˆ©æ€§è´¨ï¼ˆè·¨ç»“æœç»„åˆï¼‰
     - æç«¯å€¼å¤„ç†ï¼ˆ0.01%, 99.99%ï¼‰
   - é›†æˆæµ‹è¯•:
     - ä¸ MarketBase é›†æˆ
     - å¤šç”¨æˆ·å¹¶å‘äº¤æ˜“
     - å¤§é¢äº¤æ˜“æ»‘ç‚¹
   - ä¸å˜é‡æµ‹è¯• (Echidna):
     - `Î£ p_i = 1` (æ¦‚ç‡æ€»å’Œä¸º 1)
     - `C(q)` å•è°ƒé€’å¢
     - ä¹°å…¥åå–å‡ºä¸ä¼šè·åˆ©ï¼ˆè€ƒè™‘è´¹ç”¨ï¼‰

5. **Gas ä¼˜åŒ–**
   - æ‰¹é‡è®¡ç®—æ¦‚ç‡ï¼ˆé¿å…é‡å¤ exp è®¡ç®—ï¼‰
   - ç¼“å­˜ä¸­é—´ç»“æœ
   - ä½¿ç”¨æ±‡ç¼–ä¼˜åŒ–å…³é”®è·¯å¾„

#### äº¤ä»˜ç‰©
- âœ… `contracts/src/pricing/LMSR.sol` (â‰ˆ500 è¡Œ)
- âœ… `contracts/test/unit/LMSR.t.sol` (â‰¥25 æµ‹è¯•)
- âœ… `contracts/docs/LMSR_Usage.md` (æŠ€æœ¯æ–‡æ¡£)
- âœ… Gas æŠ¥å‘Šå’Œå¯¹æ¯”åˆ†æ

---

### ä»»åŠ¡ 2: ScoreTemplate ç²¾ç¡®æ¯”åˆ†å¸‚åœº (25 ç‚¹, Week 9-10)

#### èƒŒæ™¯
- ç²¾ç¡®æ¯”åˆ†æ˜¯åšå½©å¹³å°çš„æ ¸å¿ƒç©æ³•ä¹‹ä¸€
- å…¸å‹ç»“æœæ•°é‡: 25-50 ä¸ªï¼ˆå¦‚ 0-0 åˆ° 5-5ï¼Œä»¥åŠ Otherï¼‰
- å¿…é¡»ä½¿ç”¨ LMSR å®šä»·ï¼ˆSimpleCPMM ä¸é€‚ç”¨ï¼‰

#### å®ç°èŒƒå›´
1. **æ ¸å¿ƒåˆçº¦**: `contracts/src/templates/ScoreTemplate.sol`
   - ç»§æ‰¿ `MarketBase`
   - é›†æˆ `LMSR` å®šä»·å¼•æ“
   - Outcome ID ç¼–ç : `homeGoals * 10 + awayGoals` (å¦‚ 21 = 2-1)
   - ç‰¹æ®Šç»“æœ: `999 = Other` (å…¶ä»–æ¯”åˆ†)

2. **ç»“æœç¼–ç æ–¹æ¡ˆ**
   ```solidity
   // ç¤ºä¾‹: 0-0 åˆ° 5-5 + Other
   uint256[] public validOutcomes = [
       0,   // 0-0
       1,   // 0-1
       2,   // 0-2
       ...
       55,  // 5-5
       999  // Other
   ];

   function encodeScore(uint8 home, uint8 away) returns (uint256) {
       return home * 10 + away;
   }
   ```

3. **åˆå§‹åŒ–å‚æ•°**
   - æœ€å¤§æ¯”åˆ†èŒƒå›´ (å¦‚ 0-5)
   - LMSR æµåŠ¨æ€§å‚æ•° `b`
   - åˆå§‹æ¦‚ç‡åˆ†å¸ƒï¼ˆä»é“¾ä¸‹è·å–æˆ–ä½¿ç”¨é»˜è®¤ï¼‰
   - è´¹ç‡é…ç½®

4. **ç»“ç®—é€»è¾‘**
   - ä» Oracle è·å–æœ€ç»ˆæ¯”åˆ†
   - æ˜ å°„åˆ° Outcome ID
   - å¦‚æœæ¯”åˆ†è¶…å‡ºèŒƒå›´ï¼Œç»“ç®—ä¸º `Other`
   - æ”¯æŒåŠ æ—¶/ç‚¹çƒæ¯”åˆ†ï¼ˆå¯é€‰ï¼‰

5. **æµ‹è¯•è®¡åˆ’** (â‰¥30 ä¸ªæµ‹è¯•)
   - åˆå§‹åŒ–æµ‹è¯•:
     - æœ‰æ•ˆçš„æ¦‚ç‡åˆ†å¸ƒ
     - Outcome ID ç¼–ç æ­£ç¡®æ€§
   - ä¸‹æ³¨æµ‹è¯•:
     - å¤šç”¨æˆ·ä¸‹æ³¨ä¸åŒæ¯”åˆ†
     - ä»·æ ¼å˜åŒ–ç¬¦åˆ LMSR é¢„æœŸ
     - æ»‘ç‚¹ä¿æŠ¤ç”Ÿæ•ˆ
   - ç»“ç®—æµ‹è¯•:
     - æ ‡å‡†æ¯”åˆ†ç»“ç®— (å¦‚ 2-1)
     - Other æ¯”åˆ†ç»“ç®— (å¦‚ 6-0)
     - å¤šç”¨æˆ·å…‘ä»˜
   - è¾¹ç•Œæµ‹è¯•:
     - æç«¯æ¦‚ç‡ä¸‹æ³¨
     - å¤§é¢ä¸‹æ³¨

6. **äº‹ä»¶å®šä¹‰**
   ```solidity
   event ScoreMarketCreated(
       address indexed market,
       string matchId,
       uint256[] validOutcomes,
       uint256 liquidityB
   );

   event ScoreBetPlaced(
       address indexed user,
       uint256 homeGoals,
       uint256 awayGoals,
       uint256 amount,
       uint256 shares
   );
   ```

#### äº¤ä»˜ç‰©
- âœ… `contracts/src/templates/ScoreTemplate.sol` (â‰ˆ600 è¡Œ)
- âœ… `contracts/test/unit/ScoreTemplate.t.sol` (â‰¥30 æµ‹è¯•)
- âœ… ç»“ç®—è„šæœ¬ (forge script)
- âœ… æ–‡æ¡£æ›´æ–° (EVENT_DICTIONARY.md)

---

### ä»»åŠ¡ 3: PlayerProps_Template çƒå‘˜é“å…·å¸‚åœº (15 ç‚¹, Week 10-11)

#### èƒŒæ™¯
- çƒå‘˜é“å…·æ˜¯å¢é•¿æœ€å¿«çš„åšå½©å“ç±»ä¹‹ä¸€
- å…¸å‹ç©æ³•: è¿›çƒæ•° OU, åŠ©æ”»æ•° OU, å°„é—¨æ¬¡æ•° OU, é»„ç‰Œ Yes/No
- å¯ä½¿ç”¨ SimpleCPMM (äºŒ/ä¸‰å‘å¸‚åœº)

#### å®ç°èŒƒå›´
1. **æ ¸å¿ƒåˆçº¦**: `contracts/src/templates/PlayerProps_Template.sol`
   - ç»§æ‰¿ `MarketBase`
   - æ”¯æŒå¤šç§é“å…·ç±»å‹ (enum PropType)
   - é›†æˆ SimpleCPMM æˆ– LMSRï¼ˆæ ¹æ®ç»“æœæ•°é‡ï¼‰

2. **é“å…·ç±»å‹å®šä¹‰**
   ```solidity
   enum PropType {
       GOALS_OU,        // è¿›çƒæ•°å¤§å°çƒ (äºŒå‘)
       ASSISTS_OU,      // åŠ©æ”»æ•°å¤§å°çƒ (äºŒå‘)
       SHOTS_OU,        // å°„é—¨æ¬¡æ•°å¤§å°çƒ (äºŒå‘)
       YELLOW_CARD,     // é»„ç‰Œ Yes/No (äºŒå‘)
       ANYTIME_SCORER,  // ä»»æ„æ—¶é—´è¿›çƒ Yes/No (äºŒå‘)
       FIRST_SCORER     // é¦–ä½è¿›çƒè€… (å¤šå‘, éœ€ LMSR)
   }
   ```

3. **å¸‚åœºå‚æ•°**
   - çƒå‘˜ ID / åå­—
   - é“å…·ç±»å‹
   - ç›˜å£çº¿ï¼ˆå¦‚ 0.5, 1.5 ç­‰ï¼‰
   - æ¯”èµ›å¼•ç”¨ (matchId)

4. **ç»“ç®—é€»è¾‘**
   - ä» Oracle è·å–çƒå‘˜ç»Ÿè®¡æ•°æ®
   - æ˜ å°„åˆ°ç»“æœ (Over/Under, Yes/No)
   - æ”¯æŒçƒå‘˜æœªä¸Šåœºçš„æƒ…å†µï¼ˆé€€æ¬¾æˆ–ç‰¹æ®Šå¤„ç†ï¼‰

5. **æµ‹è¯•è®¡åˆ’** (â‰¥20 ä¸ªæµ‹è¯•)
   - å„é“å…·ç±»å‹çš„åˆ›å»ºå’Œä¸‹æ³¨
   - ç»“ç®—é€»è¾‘æ­£ç¡®æ€§
   - çƒå‘˜æœªä¸Šåœºçš„å¤„ç†
   - å¤šçƒå‘˜ç»„åˆå¸‚åœº

#### äº¤ä»˜ç‰©
- âœ… `contracts/src/templates/PlayerProps_Template.sol` (â‰ˆ400 è¡Œ)
- âœ… `contracts/test/unit/PlayerProps.t.sol` (â‰¥20 æµ‹è¯•)
- âœ… æ–‡æ¡£æ›´æ–°

---

### ä»»åŠ¡ 4: Basket/CorrelationGuard Subgraph Mapping (10 ç‚¹, Week 11)

#### èƒŒæ™¯
- Basket å’Œ CorrelationGuard åˆçº¦å·²å®Œæˆï¼ˆ50 æµ‹è¯•ï¼Œ100% é€šè¿‡ï¼‰
- éœ€è¦ Subgraph æ”¯æŒæ¥ç´¢å¼•ä¸²å…³æ•°æ®ï¼Œä¾›å‰ç«¯æŸ¥è¯¢

#### å®ç°èŒƒå›´
1. **Schema æ‰©å±•** (`subgraph/schema.graphql`)
   ```graphql
   type Parlay @entity {
     id: ID!
     parlayId: BigInt!
     user: User!
     legs: [ParlayLeg!]! @derivedFrom(field: "parlay")
     stake: BigDecimal!
     potentialPayout: BigDecimal!
     combinedOdds: BigInt!  # åŸºç‚¹
     penaltyBps: BigInt!
     status: ParlayStatus!
     createdAt: BigInt!
     settledAt: BigInt
     payout: BigDecimal
   }

   type ParlayLeg @entity {
     id: ID!
     parlay: Parlay!
     market: Market!
     outcomeId: BigInt!
     legIndex: Int!
   }

   enum ParlayStatus {
     Pending
     Won
     Lost
     Cancelled
   }

   type CorrelationRule @entity {
     id: ID!
     matchId1: Bytes!
     matchId2: Bytes!
     penaltyBps: Int!
     isBlocked: Boolean!
     updatedAt: BigInt!
   }
   ```

2. **Mapping å®ç°** (`subgraph/src/basket.ts`)
   - `handleParlayCreated`: åˆ›å»º Parlay å’Œ ParlayLeg å®ä½“
   - `handleParlaySettled`: æ›´æ–° Parlay çŠ¶æ€å’Œèµ”ä»˜
   - `handleCorrelationGuardUpdated`: æ›´æ–°ç›¸å…³æ€§å®ˆå«
   - `handleCorrelationRuleSet`: æ›´æ–°ç›¸å…³æ€§è§„åˆ™

3. **Helper å‡½æ•°**
   - `getParlayStatusString(status: i32): string`
   - `createParlayId(parlayId: BigInt): string`

4. **é…ç½®æ›´æ–°** (`subgraph/subgraph.yaml`)
   ```yaml
   - kind: ethereum/contract
     name: Basket
     network: localhost
     source:
       address: "0x..."
       abi: Basket
       startBlock: 0
     mapping:
       kind: ethereum/events
       apiVersion: 0.0.7
       language: wasm/assemblyscript
       entities:
         - Parlay
         - ParlayLeg
       abis:
         - name: Basket
           file: ./abis/Basket.json
       eventHandlers:
         - event: ParlayCreated(uint256,address,tuple[],uint256,uint256,uint256,uint256)
           handler: handleParlayCreated
         - event: ParlaySettled(uint256,address,uint8,uint256)
           handler: handleParlaySettled
       file: ./src/basket.ts
   ```

5. **æŸ¥è¯¢ç¤ºä¾‹**
   ```graphql
   # æŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰ä¸²å…³
   query UserParlays($user: Bytes!) {
     parlays(
       where: { user: $user }
       orderBy: createdAt
       orderDirection: desc
     ) {
       id
       stake
       potentialPayout
       combinedOdds
       status
       legs {
         market { id, event }
         outcomeId
       }
     }
   }

   # æŸ¥è¯¢å¾…ç»“ç®—çš„ä¸²å…³
   query PendingParlays {
     parlays(where: { status: Pending }) {
       id
       user
       createdAt
     }
   }
   ```

#### æµ‹è¯•è®¡åˆ’
- éƒ¨ç½² Basket åˆ°æœ¬åœ° Anvil
- åˆ›å»ºæµ‹è¯•ä¸²å…³
- éªŒè¯ Subgraph ç´¢å¼•æ­£ç¡®
- è¿è¡Œ GraphQL æŸ¥è¯¢æµ‹è¯•

#### äº¤ä»˜ç‰©
- âœ… Schema æ‰©å±• (5 ä¸ªæ–°å®ä½“)
- âœ… `subgraph/src/basket.ts` (â‰ˆ250 è¡Œ)
- âœ… `subgraph/src/correlation.ts` (â‰ˆ150 è¡Œ)
- âœ… subgraph.yaml é…ç½®
- âœ… æœ¬åœ°éƒ¨ç½²å’ŒéªŒè¯

---

### ä»»åŠ¡ 5: é›†æˆæµ‹è¯•ä¸ç«¯åˆ°ç«¯éªŒè¯ (8 ç‚¹, Week 11-12)

#### æµ‹è¯•èŒƒå›´
1. **ä¸²å…³ + å¸‚åœºé›†æˆæµ‹è¯•**
   - åˆ›å»ºå¤šä¸ªå¸‚åœºï¼ˆWDL, OU, AHï¼‰
   - åˆ›å»ºä¸²å…³ç»„åˆï¼ˆ2-5 è…¿ï¼‰
   - æ¨¡æ‹Ÿå¸‚åœºç»“ç®—
   - éªŒè¯ä¸²å…³ç»“ç®—å’Œèµ”ä»˜

2. **LMSR + ScoreTemplate é›†æˆæµ‹è¯•**
   - åˆ›å»ºç²¾ç¡®æ¯”åˆ†å¸‚åœº
   - å¤šç”¨æˆ·ä¸‹æ³¨ä¸åŒæ¯”åˆ†
   - æ¨¡æ‹Ÿæ¯”åˆ†ç»“ç®—
   - éªŒè¯èµ”ä»˜æ­£ç¡®æ€§

3. **ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•**
   - Anvil æœ¬åœ°é“¾
   - éƒ¨ç½²æ‰€æœ‰åˆçº¦
   - Keeper è‡ªåŠ¨åŒ–ï¼ˆé”ç›˜ã€ç»“ç®—ï¼‰
   - Indexer äº‹ä»¶è®¢é˜…
   - Subgraph æ•°æ®éªŒè¯

4. **æ€§èƒ½æµ‹è¯•**
   - å¤§é¢äº¤æ˜“ Gas æ¶ˆè€—
   - æ‰¹é‡ç»“ç®—æ€§èƒ½
   - Subgraph ç´¢å¼•é€Ÿåº¦

#### äº¤ä»˜ç‰©
- âœ… `contracts/test/integration/ParlayE2E.t.sol`
- âœ… `contracts/test/integration/ScoreMarketE2E.t.sol`
- âœ… ç«¯åˆ°ç«¯æµ‹è¯•è„šæœ¬
- âœ… æ€§èƒ½æŠ¥å‘Š

---

### ä»»åŠ¡ 6: CLOB æ’æ§½è¯„ä¼°ï¼ˆé€‰é…, 2 ç‚¹, Week 12ï¼‰

#### è¯„ä¼°ç»´åº¦
1. **ä¸šåŠ¡éœ€æ±‚**
   - AMM æµåŠ¨æ€§æ˜¯å¦æ»¡è¶³å¤§é¢äº¤æ˜“ï¼Ÿ
   - æ˜¯å¦éœ€è¦é™ä»·å•åŠŸèƒ½ï¼Ÿ
   - ä¸“ä¸šç”¨æˆ·çš„å æ¯”å’Œéœ€æ±‚

2. **æŠ€æœ¯å¯è¡Œæ€§**
   - é“¾ä¸Š CLOB çš„ Gas æˆæœ¬
   - è®¢å•ç°¿æ·±åº¦å’Œæ›´æ–°é¢‘ç‡
   - MEV é£é™©å’Œå…¬å¹³æ€§

3. **æ’æ§½è®¾è®¡**
   - æ¥å£å®šä¹‰ `IOrderbook`
   - ä¸ AMM çš„æµåŠ¨æ€§èšåˆ
   - è®¢å•åŒ¹é…é€»è¾‘ï¼ˆé“¾ä¸Š vs é“¾ä¸‹ï¼‰

4. **å®ç°è·¯å¾„**
   - æ–¹æ¡ˆ A: çº¯é“¾ä¸Š CLOBï¼ˆé«˜ Gasï¼‰
   - æ–¹æ¡ˆ B: é“¾ä¸‹è®¢å•ç°¿ + é“¾ä¸Šç»“ç®—ï¼ˆéœ€ä¸­å¿ƒåŒ–ç»„ä»¶ï¼‰
   - æ–¹æ¡ˆ C: é›†æˆç¬¬ä¸‰æ–¹ CLOB åè®®ï¼ˆå¦‚ dYdX, Vertexï¼‰

#### äº¤ä»˜ç‰©
- âœ… `docs/design/CLOB_Evaluation.md` (è¯„ä¼°æŠ¥å‘Š)
- âœ… æ¥å£è®¾è®¡è‰æ¡ˆï¼ˆå¦‚æœå†³å®šå®ç°ï¼‰

---

## ğŸ“… æ—¶é—´è§„åˆ’

| Week | æ—¥æœŸ | ä¸»è¦ä»»åŠ¡ | é¢„ä¼°ç‚¹æ•° | äº¤ä»˜ç‰© |
|------|------|---------|---------|--------|
| Week 8 | 12/17-12/23 | LMSR å¼•æ“å¼€å‘ (Part 1) | 15 | LMSR.sol æ ¸å¿ƒå®ç° + åŸºç¡€æµ‹è¯• |
| Week 9 | 12/24-12/30 | LMSR å¼•æ“å®Œæˆ + ScoreTemplate å¼€å‘ (Part 1) | 15+10 | LMSR å®Œæ•´æµ‹è¯• + ScoreTemplate æ ¸å¿ƒ |
| Week 10 | 12/31-01/06 | ScoreTemplate å®Œæˆ + PlayerProps å¼€å‘ | 15+10 | ScoreTemplate æµ‹è¯• + PlayerProps å®ç° |
| Week 11 | 01/07-01/13 | PlayerProps å®Œæˆ + Subgraph Mapping + é›†æˆæµ‹è¯• | 5+10+8 | æ‰€æœ‰æ¨¡æ¿å®Œæˆ + Subgraph éƒ¨ç½² |
| Week 12 | 01/14-01/19 | CLOB è¯„ä¼° + æ–‡æ¡£å®Œå–„ + M3 æ”¶å°¾ | 2 | M3 å®ŒæˆæŠ¥å‘Š |

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### åˆçº¦å±‚
- âœ… LMSR å®šä»·å¼•æ“å®Œæˆï¼Œâ‰¥25 æµ‹è¯•ï¼Œè¦†ç›–ç‡ â‰¥90%
- âœ… ScoreTemplate å®Œæˆï¼Œâ‰¥30 æµ‹è¯•ï¼Œè¦†ç›–ç‡ â‰¥85%
- âœ… PlayerProps_Template å®Œæˆï¼Œâ‰¥20 æµ‹è¯•
- âœ… æ‰€æœ‰æµ‹è¯• 100% é€šè¿‡
- âœ… Slither æ‰«æ 0 ä¸­é«˜å±é—®é¢˜

### Subgraph å±‚
- âœ… Basket/CorrelationGuard Mapping å®Œæˆ
- âœ… æœ¬åœ°éƒ¨ç½²æˆåŠŸï¼Œç´¢å¼•å¥åº·
- âœ… GraphQL æŸ¥è¯¢æµ‹è¯•é€šè¿‡

### é›†æˆæµ‹è¯•
- âœ… ç«¯åˆ°ç«¯æµç¨‹æ‰“é€šï¼ˆåˆ›å»º â†’ ä¸‹æ³¨ â†’ é”ç›˜ â†’ ç»“ç®— â†’ å…‘ä»˜ï¼‰
- âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡ï¼ˆGas ä¼˜åŒ–ï¼Œç´¢å¼•é€Ÿåº¦ï¼‰

### æ–‡æ¡£
- âœ… æŠ€æœ¯æ–‡æ¡£å®Œæ•´ (LMSR_Usage.md, ScoreTemplate_Usage.md)
- âœ… EVENT_DICTIONARY.md æ›´æ–°
- âœ… M3 å®Œæˆæ€»ç»“æŠ¥å‘Š

---

## ğŸ”— ç›¸å…³èµ„æº

### å‚è€ƒå®ç°
- **LMSR**:
  - [Gnosis Conditional Tokens](https://github.com/gnosis/conditional-tokens-contracts)
  - [Augur v2 LMSR](https://github.com/AugurProject/augur-core)
- **æ•°å€¼åº“**:
  - [PRBMath](https://github.com/PaulRBerg/prb-math) - é«˜ç²¾åº¦æ•°å­¦åº“
  - [Balancer LogExpMath](https://github.com/balancer/balancer-v2-monorepo/blob/master/pkg/solidity-utils/contracts/math/LogExpMath.sol)

### å­¦æœ¯è®ºæ–‡
- Hanson, R. (2003). "Combinatorial Information Market Design"
- Chen, Y., & Pennock, D. M. (2007). "A utility framework for bounded-loss market makers"

### å†…éƒ¨æ–‡æ¡£
- `docs/design/02_AMM_LinkedLines.md` - AMM è®¾è®¡æ–‡æ¡£
- `docs/design/04_Parlay_CorrelationGuard.md` - ä¸²å…³è®¾è®¡æ–‡æ¡£
- `docs/æ¨¡å—æ¥å£äº‹ä»¶å‚æ•°/EVENT_DICTIONARY.md` - äº‹ä»¶å­—å…¸

---

## ğŸ“ é£é™©ä¸ç¼“è§£

### æŠ€æœ¯é£é™©
1. **LMSR æ•°å€¼ç¨³å®šæ€§é—®é¢˜**
   - é£é™©: æŒ‡æ•°æº¢å‡ºã€ç²¾åº¦æŸå¤±
   - ç¼“è§£: ä½¿ç”¨ LogExpMath åº“ï¼Œæ·»åŠ è¾¹ç•Œæ£€æŸ¥

2. **ç²¾ç¡®æ¯”åˆ†å¸‚åœºçš„é«˜ Gas æˆæœ¬**
   - é£é™©: 25-50 ä¸ªç»“æœå¯¼è‡´çŠ¶æ€æ›´æ–°æ˜‚è´µ
   - ç¼“è§£: æ‰¹é‡æ“ä½œä¼˜åŒ–ï¼Œä½¿ç”¨ç´§å‡‘å­˜å‚¨

3. **ä¸²å…³ç³»ç»Ÿçš„å¤æ‚æ€§**
   - é£é™©: å¤šå¸‚åœºç»“ç®—çš„è¾¹ç•Œæƒ…å†µ
   - ç¼“è§£: å·²æœ‰ 50 ä¸ªæµ‹è¯•è¦†ç›–ï¼Œæ·»åŠ æ›´å¤šé›†æˆæµ‹è¯•

### è¿›åº¦é£é™©
1. **LMSR å®ç°éš¾åº¦è¶…é¢„æœŸ**
   - ç¼“è§£: Week 8 ä¼˜å…ˆå®Œæˆ LMSRï¼Œç•™å‡ºç¼“å†²æ—¶é—´

2. **Subgraph ç´¢å¼•æ€§èƒ½é—®é¢˜**
   - ç¼“è§£: å…ˆå®ç°åŸºç¡€åŠŸèƒ½ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸ºåç»­è¿­ä»£

---

## âœ¨ M3 åçš„è§„åˆ’

### M4 (å¯é€‰æ‰©å±•)
1. **Promoter SBT + Staking** (10 ç‚¹)
2. **å‰ç«¯å®Œæ•´å®ç°** (20 ç‚¹)
3. **æµ‹è¯•ç½‘éƒ¨ç½²å’Œå®¡è®¡å‡†å¤‡** (15 ç‚¹)
4. **Bug Bounty å’Œç¤¾åŒºæµ‹è¯•** (10 ç‚¹)

### é•¿æœŸä¼˜åŒ–
1. Gas ä¼˜åŒ–ï¼ˆç›®æ ‡: -30%ï¼‰
2. åŠ¨æ€å‚æ•°è°ƒæ•´ï¼ˆML é©±åŠ¨ï¼‰
3. è·¨é“¾éƒ¨ç½²ï¼ˆL2 æ‰©å±•ï¼‰

---

**ç¼–åˆ¶è€…**: Claude Code
**ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-08
